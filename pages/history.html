<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Claim Details - Verifact</title>
    <meta name="description" content="Detailed view of a verified claim.">

    <!-- Favicon -->
    <link rel="icon" href="../public/favicon.ico" sizes="any"> 
    <link href="../src/output.css" rel="stylesheet">

    <style>
      ::-webkit-scrollbar { width: 8px; height: 8px; }
      ::-webkit-scrollbar-track { background: #f1f5f9; }
      ::-webkit-scrollbar-thumb { background: #94a3b8; border-radius: 4px; }
      ::-webkit-scrollbar-thumb:hover { background: #64748b; }

      body {
        font-family: 'Inter', 'Noto Sans', sans-serif;
      }

      .prose p { margin-bottom: 1em; }
      .prose ul { list-style-type: disc; margin-left: 1.5em; margin-bottom: 1em; }
    </style>
</head>
<body class="font-['Inter','Noto_Sans',sans-serif]">

    <div class="flex flex-col h-screen overflow-hidden">
      <!-- Header -->
      <header class="flex-shrink-0 h-16 bg-white border-b border-slate-200 flex items-center justify-between px-4 sm:px-6 z-30">
        <div class="flex items-center">
          <button
            type="button"
            id="mobile-sidebar-toggle"
            class="lg:hidden -ml-1.5 mr-3 p-2 rounded-md text-slate-500 hover:text-slate-700 focus:outline-none focus:ring-2 focus:ring-sky-500"
            aria-controls="sidebar"
            aria-expanded="false"
            title="Open sidebar menu"
            aria-label="Open sidebar menu"
          >
            <span class="sr-only">Open sidebar</span>
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="h-6 w-6"><use href="#bars3-icon-path" /></svg>
          </button>
          <a href="index.html" class="flex items-center gap-2 group">
            <img class="h-8 w-auto" src="../assets/verifact-logo.png" alt="Verifact Logo" /> <!-- Adjusted path -->
            <span class="text-xl font-bold text-slate-800 group-hover:text-sky-600 transition-colors hidden sm:inline">Verifact</span>
          </a>
        </div>
        <div class="relative">
          <button
            id="user-menu-button"
            type="button"
            class="flex items-center p-1 rounded-full text-slate-500 hover:text-sky-600 focus:outline-none focus:ring-2 focus:ring-offset-1 focus:ring-sky-500"
            aria-expanded="false" aria-haspopup="true" title="Open user menu" aria-label="Open user menu"
          >
            <span class="sr-only">Open user menu</span>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="h-7 w-7 sm:h-8 sm:w-8"><use href="#user-solid-icon-path" /></svg>
          </button>
          <div id="user-menu-dropdown" class="hidden origin-top-right absolute right-0 mt-2 w-48 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 py-1 z-40">
            <ul>
              <li><a href="profile.html" class="user-menu-item block px-4 py-2 text-sm text-slate-700 hover:bg-slate-100 hover:text-sky-600 transition-colors">User Profile</a></li>
              <li><a href="logout.html" class="user-menu-item block px-4 py-2 text-sm text-slate-700 hover:bg-slate-100 hover:text-sky-600 transition-colors">Logout</a></li> <!-- Assuming logout.html -->
            </ul>
          </div>
        </div>
      </header>

      <div class="flex flex-1 overflow-hidden">
        <!-- Mobile overlay for Sidebar -->
        <div id="mobile-sidebar-overlay" class="hidden fixed inset-0 z-30 bg-black/40 backdrop-blur-sm lg:hidden"></div>

        <!-- Sidebar Component -->
        <div
          id="sidebar"
          class="fixed inset-y-0 left-0 z-40 w-64 transform transition-transform duration-300 ease-in-out -translate-x-full
                 lg:relative lg:z-auto lg:translate-x-0 h-[calc(100vh-4rem)] 
                 bg-gradient-to-br from-slate-50 to-white border-r border-slate-200/80 shadow-sm"
        >
           <aside class="flex flex-col h-full w-full overflow-hidden">
            <div class="flex items-center justify-end h-16 px-3 border-b border-slate-200/60 flex-shrink-0 bg-white/70 backdrop-blur-sm">
              <button id="sidebar-toggle-desktop" class="p-2 rounded-lg text-slate-500 hover:text-emerald-600 hover:bg-emerald-50 focus:outline-none focus:ring-2 focus:ring-offset-1 focus:ring-emerald-400 hidden lg:block ml-2 flex-shrink-0 transition-all duration-200" title="Collapse sidebar" aria-expanded="true" aria-controls="sidebar-nav">
                <span class="sr-only">Collapse sidebar</span>
                <svg id="sidebar-collapse-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="h-5 w-5"><use href="#chevron-double-left-icon-path" /></svg>
                <svg id="sidebar-expand-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="h-5 w-5 hidden"><use href="#chevron-double-right-icon-path" /></svg>
              </button>
            </div>
            <nav id="sidebar-nav" class="flex-1 overflow-y-auto overflow-x-hidden pt-6 pb-4">
              <div class="mb-4 last:mb-0">
                <ul role="list" class="space-y-2">
                  <li class="px-3">
                    <a href="chat.html" title="Verify New Claim" class="sidebar-nav-item group flex items-center rounded-xl py-3 text-sm font-medium transition-all duration-200 ease-in-out transform hover:scale-[1.02] px-4 text-slate-600 hover:bg-gradient-to-r hover:from-emerald-50 hover:to-teal-50 hover:text-emerald-700 hover:shadow-md">
                      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="h-5 w-5 flex-shrink-0 mr-3 text-slate-500 group-hover:text-emerald-600"><use href="#check-badge-icon-path" /></svg>
                      <span class="sidebar-text truncate font-medium">Verify New Claim</span>
                    </a>
                  </li>
                  <li class="px-3">
                    <a href="history-list.html" title="History" class="sidebar-nav-item group flex items-center rounded-xl py-3 text-sm font-medium transition-all duration-200 ease-in-out transform hover:scale-[1.02] px-4 bg-gradient-to-r from-emerald-500 to-teal-500 text-white shadow-lg shadow-emerald-500/30" aria-current="page">
                      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="h-5 w-5 flex-shrink-0 mr-3 text-white drop-shadow-sm"><use href="#document-text-icon-path" /></svg>
                      <span class="sidebar-text truncate font-medium">History</span>
                    </a>
                  </li>
                </ul>
              </div>
              <div class="mt-8 last:mb-0">
                <h3 class="sidebar-text mb-3 px-4 text-xs font-bold uppercase tracking-widest text-slate-500 transition-opacity duration-300 opacity-100 h-auto" aria-hidden="false">ACCOUNT</h3>
                <ul role="list" class="space-y-2">
                  <li class="px-3">
                    <a href="profile.html" title="Profile" class="sidebar-nav-item group flex items-center rounded-xl py-3 text-sm font-medium transition-all duration-200 ease-in-out transform hover:scale-[1.02] px-4 text-slate-600 hover:bg-gradient-to-r hover:from-emerald-50 hover:to-teal-50 hover:text-emerald-700 hover:shadow-md">
                      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="h-5 w-5 flex-shrink-0 mr-3 text-slate-500 group-hover:text-emerald-600"><use href="#user-icon-outline-path" /></svg>
                      <span class="sidebar-text truncate font-medium">Profile</span>
                    </a>
                  </li>
                  <li class="px-3">
                    <a href="settings.html" title="Settings" class="sidebar-nav-item group flex items-center rounded-xl py-3 text-sm font-medium transition-all duration-200 ease-in-out transform hover:scale-[1.02] px-4 text-slate-600 hover:bg-gradient-to-r hover:from-emerald-50 hover:to-teal-50 hover:text-emerald-700 hover:shadow-md">
                      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="h-5 w-5 flex-shrink-0 mr-3 text-slate-500 group-hover:text-emerald-600"><use href="#cog-6-tooth-icon-path" /></svg>
                      <span class="sidebar-text truncate font-medium">Settings</span>
                    </a>
                  </li>
                  <li class="px-3">
                    <a href="#" title="Security" class="sidebar-nav-item group flex items-center rounded-xl py-3 text-sm font-medium transition-all duration-200 ease-in-out transform hover:scale-[1.02] px-4 cursor-not-allowed text-slate-400">
                      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="h-5 w-5 flex-shrink-0 mr-3 text-slate-300"><use href="#shield-check-icon-path" /></svg>
                      <span class="sidebar-text truncate font-medium">Security</span>
                    </a>
                  </li>
                </ul>
              </div>
            </nav>
            <div id="sidebar-user-profile-area" class="flex-shrink-0 border-t border-slate-200/60 p-4 bg-gradient-to-r from-slate-50/50 to-emerald-50/30 h-auto">
              <a href="profile.html" class="group block transition-all duration-200 hover:scale-105 flex-shrink-0 overflow-hidden" title="User Profile">
                <div class="flex items-center p-2 rounded-xl hover:bg-white/70 transition-all duration-200">
                  <div class="relative">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="sidebar-user-icon h-10 w-10 text-slate-400 group-hover:text-emerald-600 transition-colors"><use href="#user-icon-outline-path" /></svg>
                    <div class="sidebar-user-status-indicator absolute -bottom-1 -right-1 w-3 h-3 bg-emerald-400 rounded-full border-2 border-white"></div>
                  </div>
                  <div class="sidebar-text ml-3 min-w-0">
                    <p class="text-sm font-semibold text-slate-700 group-hover:text-slate-900 truncate">Bola A. Tinubu</p>
                    <p class="text-xs font-medium text-emerald-600 group-hover:text-emerald-700 truncate">View Profile</p>
                  </div>
                </div>
              </a>
            </div>
          </aside>
        </div>

        <!-- History Content Area (ClaimDetailComponent) -->
        <main class="flex-1 overflow-y-auto focus:outline-none" id="history-content-area">
            <div id="claim-detail-placeholder">
                <div id="claim-detail-loading" class="flex flex-col items-center justify-center min-h-[calc(100vh-8rem)] p-6 bg-slate-100">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-12 h-12 text-sky-500 animate-spin mb-4">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182m0-4.991v4.99" />
                    </svg>
                    <p class="text-lg text-slate-600">Loading claim details...</p>
                </div>
                <div id="claim-detail-error" class="hidden flex-col items-center justify-center min-h-[calc(100vh-8rem)] p-6 bg-red-50 rounded-xl border border-red-200">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-12 h-12 text-red-500 mb-4">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m0-10.036A11.959 11.959 0 013.598 6 11.99 11.99 0 003 9.75c0 5.592 3.824 10.29 9 11.623 5.176-1.332 9-6.03 9-11.622 0 3.462-1.713 6.625-4.423 8.636m-1.028-9.742A11.959 11.959 0 013.598 6 11.99 11.99 0 003 9.75c0 5.592 3.824 10.29 9 11.623 5.176-1.332 9-6.03 9-11.622A12 12 0 0012 3.036z" />
                    </svg>
                    <h3 class="text-xl font-semibold text-red-700 mb-2">Error Loading Claim</h3>
                    <p id="error-message-text" class="text-red-600 text-sm mb-6">The requested claim could not be found.</p>
                    <a href="history-list.html" id="back-to-history-error-button" class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-sky-600 hover:bg-sky-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-sky-500">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5 mr-2">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5L3 12m0 0l7.5-7.5M3 12h18" />
                        </svg>
                        Back to History List
                    </a>
                </div>
                <div id="claim-detail-content" class="hidden min-h-full bg-slate-100 p-4 sm:p-6 lg:p-8">
                  <!-- Content will be dynamically inserted here -->
                </div>
            </div>
        </main>
      </div>
    </div>
    
    <!-- Reusable SVG Icon Definitions -->
    <svg class="hidden">
      <defs>
        <path id="bars3-icon-path" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5" />
        <path id="user-solid-icon-path" fill-rule="evenodd" d="M18.685 19.097A9.723 9.723 0 0021.75 12c0-5.385-4.365-9.75-9.75-9.75S2.25 6.615 2.25 12a9.723 9.723 0 003.065 7.097A9.716 9.716 0 0012 21.75a9.716 9.716 0 006.685-2.653zm-12.54-1.285A7.486 7.486 0 0112 15a7.486 7.486 0 015.855 2.812A8.224 8.224 0 0112 20.25a8.224 8.224 0 01-5.855-2.438zM15.75 9a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0z" clip-rule="evenodd" />
        <path id="chevron-double-left-icon-path" d="M18.75 19.5l-7.5-7.5 7.5-7.5m-6 15L5.25 12l7.5-7.5" />
        <path id="chevron-double-right-icon-path" d="M11.25 4.5l7.5 7.5-7.5 7.5m-6-15l7.5 7.5-7.5 7.5" />
        <path id="check-badge-icon-path" d="M9 12.75L11.25 15 15 9.75M21 12c0 1.268-.63 2.39-1.593 3.068a3.745 3.745 0 01-1.043 3.296 3.745 3.745 0 01-3.296 1.043A3.745 3.745 0 0112 21c-1.268 0-2.39-.63-3.068-1.593a3.745 3.745 0 01-3.296-1.043 3.745 3.745 0 01-1.043-3.296A3.745 3.745 0 013 12c0-1.268.63-2.39 1.593-3.068a3.745 3.745 0 011.043-3.296 3.746 3.746 0 013.296-1.043A3.746 3.746 0 0112 3c1.268 0 2.39.63 3.068 1.593a3.746 3.746 0 013.296 1.043 3.746 3.746 0 011.043 3.296A3.745 3.745 0 0121 12z" />
        <path id="document-text-icon-path" d="M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z" />
        <path id="user-icon-outline-path" d="M17.982 18.725A7.488 7.488 0 0012 15.75a7.488 7.488 0 00-5.982 2.975m11.963 0a9 9 0 10-11.963 0m11.963 0A8.966 8.966 0 0112 21a8.966 8.966 0 01-5.982-2.275M15 9.75a3 3 0 11-6 0 3 3 0 016 0z" />
        <path id="cog-6-tooth-icon-path" d="M4.5 12a7.5 7.5 0 0015 0m-15 0a7.5 7.5 0 1115 0m-15 0H3m18 0h-1.5m-15 0H3.039M20.962 12a9 9 0 11-18 0 9 9 0 0118 0zM12 6.75v.01M12 12.75v.01M12 18.75v.01M15.75 12a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0z" />
        <path id="shield-check-icon-path" d="M9 12.75L11.25 15 15 9.75m-3-7.036A11.959 11.959 0 013.598 6 11.99 11.99 0 003 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.332 9-6.03 9-11.622a11.99 11.99 0 00-.598-3.75h-.152c-3.196 0-6.1-1.248-8.25-3.285z" />
        <path id="status-verified-icon-solid" fill-rule="evenodd" d="M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12zm13.36-1.814a.75.75 0 10-1.22-.872l-3.236 4.53L9.53 12.22a.75.75 0 00-1.06 1.06l2.25 2.25a.75.75 0 001.14-.094l3.75-5.25z" clip-rule="evenodd" />
        <path id="status-debunked-icon-solid" fill-rule="evenodd" d="M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25zm-1.72 6.97a.75.75 0 10-1.06 1.06L10.94 12l-1.72 1.72a.75.75 0 101.06 1.06L12 13.06l1.72 1.72a.75.75 0 101.06-1.06L13.06 12l1.72-1.72a.75.75 0 10-1.06-1.06L12 10.94l-1.72-1.72z" clip-rule="evenodd" />
        <path id="status-pending-icon-solid" fill-rule="evenodd" d="M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25zM12.75 6a.75.75 0 00-1.5 0v6c0 .414.336.75.75.75h4.5a.75.75 0 000-1.5h-3.75V6z" clip-rule="evenodd" />
        <path id="status-inconclusive-icon-solid" fill-rule="evenodd" d="M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12zm8.25-1.5a.75.75 0 01.75-.75h.01a.75.75 0 01.75.75v.01a.75.75 0 01-.75.75H11.25a.75.75 0 01-.75-.75v-.01zM10.5 12a1.5 1.5 0 113 0 1.5 1.5 0 01-3 0zm1.5-3.75a.75.75 0 00-.75.75v.008c0 .787.612 1.42.056 1.42H12a.75.75 0 00.75-.75V9a.75.75 0 00-.75-.75h-.008A.75.75 0 0012 8.25z" clip-rule="evenodd" />
        <path id="link-icon-solid" d="M13.19 8.688a4.5 4.5 0 011.242 7.244l-4.5 4.5a4.5 4.5 0 01-6.364-6.364l1.757-1.757m13.35-.622l1.757-1.757a4.5 4.5 0 00-6.364-6.364l-4.5 4.5a4.5 4.5 0 001.242 7.244" />
        <path id="chat-bubble-icon-solid" d="M20.25 8.511c.884.284 1.5 1.128 1.5 2.097v4.286c0 1.136-.847 2.1-1.98 2.193-.34.027-.68.052-1.02.072v3.091l-3.68-3.091a4.501 4.501 0 00-1.598-.316N4.23 16.5c-1.136 0-2.1-.847-2.193-1.98-.027-.34-.052-.68-.072-1.02V9.75c0-1.136.847-2.1 1.98-2.193.34-.027.68-.052 1.02-.072l3.091-3.68L12.9 3.75c.316.027.64.049.95.072l3.091 3.68c.316.027.64.049.95.072Zm-4.52-1.67H13.5c-.454 0-.888.125-1.269.35l-3.091 2.473c-.236.188-.487.333-.702.468V6.75c0-.414.336-.75.75-.75h3.375c.414 0 .75.336.75.75v1.091Z" />
        <path id="paperclip-icon-solid" d="M18.375 12.739l-7.693 7.693a4.5 4.5 0 01-6.364-6.364l10.94-10.94A3 3 0 1119.5 7.372L8.552 18.32m.009-.01l-.01.01m5.699-9.941l-7.687 7.687a1.5 1.5 0 01-2.121-2.121l10.925-10.925a3 3 0 114.243 4.243l-7.684 7.685a1.5 1.5 0 01-2.122-2.122m0 0l.01-.01" />
      </defs>
    </svg>

    <script>
      document.addEventListener('DOMContentLoaded', () => {
        // --- Shared Mock Data for History ---
        const allHistoryItems = [
          { id: '1', claimText: "Scientists discover a new species of glowing mushrooms in the Amazon rainforest that could revolutionize bioluminescent technology.", verificationDate: new Date(2023, 10, 15, 9, 30).toISOString(), status: 'pending', summary: 'Initial checks indicate this is a recent claim circulating on social media. Further verification is in progress to confirm sources and scientific backing.', detailedExplanation: "The claim about glowing mushrooms is currently under investigation. Preliminary searches show some social media buzz but no confirmed scientific publications yet. We are contacting mycology experts for their input.\n\nUpdate: Some species of fungi are naturally bioluminescent, but a 'new species' with revolutionary tech potential requires peer-reviewed evidence which is currently lacking.", evidenceLinks: [{title: 'Nature News: Bioluminescent Fungi', url:'#'}]},
          { id: '2', claimText: "A new study shows that drinking coffee can increase your lifespan by an average of 5 years.", verificationDate: new Date(2023, 9, 22, 14, 0).toISOString(), status: 'verified', summary: 'Multiple peer-reviewed studies correlate regular coffee consumption with reduced mortality risk. The "5 years" claim is an oversimplification, but the general health benefit is supported.', imageUrl: "https://images.unsplash.com/photo-1559496417-e7f25cb247f3?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Mnx8Y29mZmVlfGVufDB8fDB8fHww&auto=format&fit=crop&w=800&q=80", originalSource: 'Global Health Times', detailedExplanation: "Multiple peer-reviewed epidemiological studies have indeed found a correlation between regular coffee consumption (typically 2-4 cups per day) and a reduced risk of mortality from various causes, including heart disease, stroke, and some cancers. While these studies are largely observational and don't definitively prove causation, the consistency of findings across large populations is significant.\n\nThe claim of an 'average of 5 years' increase is likely an oversimplification or an optimistic interpretation of some specific study's findings. The actual impact on lifespan is complex and varies based on individual genetics, lifestyle, and the type of coffee consumed. However, the general consensus is that moderate coffee consumption is associated with health benefits for most adults.\n\nIt's important to note that excessive coffee intake can have negative side effects, and individuals with certain health conditions should consult their doctor.", evidenceLinks: [{ title: 'Harvard T.H. Chan: Coffee and Health', url: '#' }, { title: 'BMJ Meta-Analysis on Coffee Consumption', url: '#' }] },
          { id: '3', claimText: "Viral video claims tap water in New York City is unsafe due to microplastic contamination making it glow blue under UV light.", verificationDate: new Date(2023, 8, 5, 11, 15).toISOString(), status: 'debunked', summary: 'NYC official water reports and independent tests show tap water meets safety standards. The "glowing water" effect in the video is likely due to added substances or lighting tricks, not inherent contamination.', detailedExplanation: "The claim that NYC tap water glows blue due to microplastic contamination is false. Official reports from the NYC Department of Environmental Protection consistently show that the city's tap water meets or exceeds all federal and state safety standards. Microplastics are an emerging concern globally, but there is no evidence they cause water to glow blue or that NYC water has dangerous levels.\n\nThe video likely uses an additive (like tonic water, which contains quinine and fluoresces under UV light) or special lighting effects to create the illusion. This is a common tactic in misinformation campaigns designed to cause alarm.", evidenceLinks: [{title: 'NYC DEP Water Quality Report', url:'#'}]},
          { id: '4', claimText: "Is it true that cats always land on their feet? A myth-busting investigation.", verificationDate: new Date(2023, 7, 1, 16, 45).toISOString(), status: 'verified', summary: "Cats have a 'righting reflex' that allows them to orient themselves mid-air. While highly effective, it's not foolproof, especially from short falls or if the cat is unwell.", detailedExplanation: "Cats possess an innate ability called the 'righting reflex,' which allows them to orient their bodies during a fall to land on their feet. This involves a complex series of movements starting with the head, then the spine, and finally the legs. This reflex is typically developed by the time a kitten is 6-7 weeks old.\n\nHowever, the statement that cats *always* land on their feet is an overstatement. The effectiveness of the reflex depends on the height of the fall (too short, and they may not have time to orient; too high, and the impact force can still cause injury despite landing on their feet) and the cat's physical condition. Injuries can still occur.", imageUrl: "https://images.unsplash.com/photo-1514888286974-6c03e2ca1dba?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Mnx8Y2F0fGVufDB8fDB8fHww&auto=format&fit=crop&w=800&q=60"},
          { id: '5', claimText: "Reports suggest a new AI can predict stock market movements with 99% accuracy, leading to concerns about market stability.", verificationDate: new Date(2023, 11, 1, 10, 0).toISOString(), status: 'pending', summary: "This claim is under review. Predicting markets with such high accuracy is historically improbable. We are investigating the source and methodology.", detailedExplanation: "The claim of an AI predicting stock markets with 99% accuracy is highly dubious and currently unverified. Financial markets are notoriously complex and influenced by a vast number of unpredictable factors. While AI is increasingly used in algorithmic trading and market analysis, achieving such a high and consistent prediction rate would represent an unprecedented breakthrough and would likely have already caused significant market disruption if true.\n\nWe are searching for credible sources or research papers to support this claim. Most often, such claims originate from scams or exaggerated marketing for financial products.", evidenceLinks: [] }
        ];

        // --- Sidebar and Header JS ---
        const sidebar = document.getElementById('sidebar');
        const mobileSidebarToggle = document.getElementById('mobile-sidebar-toggle');
        const mobileSidebarOverlay = document.getElementById('mobile-sidebar-overlay');
        const userMenuButton = document.getElementById('user-menu-button');
        const userMenuDropdown = document.getElementById('user-menu-dropdown');
        const desktopSidebarToggleButton = document.getElementById('sidebar-toggle-desktop');
        const sidebarCollapseIcon = document.getElementById('sidebar-collapse-icon');
        const sidebarExpandIcon = document.getElementById('sidebar-expand-icon');
        const sidebarTextElements = document.querySelectorAll('.sidebar-text');
        const sidebarNavItems = document.querySelectorAll('.sidebar-nav-item');
        const sidebarUserProfileArea = document.getElementById('sidebar-user-profile-area');
        const sidebarUserIcon = document.querySelector('.sidebar-user-icon');
        const sidebarUserStatusIndicator = document.querySelector('.sidebar-user-status-indicator');

        let isSidebarCollapsed = localStorage.getItem('sidebarCollapsed') === 'true';
        let isMobileSidebarOpen = false;
        let isUserMenuOpen = false;
        let wasDesktopCollapsedBeforeMobileOpen = false;


        const applyDesktopCollapseStyles = (collapse) => {
            sidebar.classList.toggle('w-64', !collapse);
            sidebar.classList.toggle('w-20', collapse);
            if (sidebarCollapseIcon) sidebarCollapseIcon.classList.toggle('hidden', collapse);
            if (sidebarExpandIcon) sidebarExpandIcon.classList.toggle('hidden', !collapse);
            
            sidebarTextElements.forEach(el => {
                el.classList.toggle('opacity-0', collapse);
                el.classList.toggle('h-0', collapse);
                el.classList.toggle('overflow-hidden', collapse);
                el.classList.toggle('opacity-100', !collapse);
                el.classList.toggle('h-auto', !collapse);
                if (el.tagName === 'H3') el.setAttribute('aria-hidden', collapse);
            });

            sidebarNavItems.forEach(item => {
                item.classList.toggle('px-3', collapse);
                item.classList.toggle('justify-center', collapse);
                item.classList.toggle('px-4', !collapse);
                const icon = item.querySelector('svg');
                if (icon) icon.classList.toggle('mr-3', !collapse);
                const textSpan = item.querySelector('.sidebar-text');
                if (collapse && textSpan) item.title = textSpan.textContent.trim();
                else item.removeAttribute('title');
            });
            
            if (sidebarUserProfileArea) {
                sidebarUserProfileArea.classList.toggle('h-[70px]', collapse);
                sidebarUserProfileArea.classList.toggle('flex', collapse);
                sidebarUserProfileArea.classList.toggle('items-center', collapse);
                sidebarUserProfileArea.classList.toggle('justify-center', collapse);
                sidebarUserProfileArea.classList.toggle('h-auto', !collapse);
                const userProfileLink = sidebarUserProfileArea.querySelector('a');
                if (userProfileLink) {
                    userProfileLink.classList.toggle('p-2', collapse);
                    userProfileLink.classList.toggle('rounded-lg', collapse);
                    userProfileLink.classList.toggle('hover:bg-emerald-100', collapse);
                }
            }
            if (sidebarUserIcon) {
                sidebarUserIcon.classList.toggle('h-7', collapse); sidebarUserIcon.classList.toggle('w-7', collapse);
                sidebarUserIcon.classList.toggle('text-slate-500', collapse); sidebarUserIcon.classList.toggle('hover:text-emerald-600', collapse);
                sidebarUserIcon.classList.toggle('h-10', !collapse); sidebarUserIcon.classList.toggle('w-10', !collapse);
                sidebarUserIcon.classList.toggle('text-slate-400', !collapse);
            }
            if(sidebarUserStatusIndicator) sidebarUserStatusIndicator.classList.toggle('hidden', collapse);
        };
        
        const toggleDesktopSidebar = () => {
            isSidebarCollapsed = !isSidebarCollapsed;
            if (desktopSidebarToggleButton) {
                desktopSidebarToggleButton.setAttribute('aria-expanded', !isSidebarCollapsed);
                desktopSidebarToggleButton.title = isSidebarCollapsed ? 'Expand sidebar' : 'Collapse sidebar';
                desktopSidebarToggleButton.querySelector('span.sr-only').textContent = isSidebarCollapsed ? 'Expand sidebar' : 'Collapse sidebar';
            }
            applyDesktopCollapseStyles(isSidebarCollapsed);
            localStorage.setItem('sidebarCollapsed', isSidebarCollapsed);
        };


        if (mobileSidebarToggle && sidebar && mobileSidebarOverlay) {
          mobileSidebarToggle.addEventListener('click', () => {
            isMobileSidebarOpen = !isMobileSidebarOpen;
            sidebar.classList.toggle('-translate-x-full', !isMobileSidebarOpen);
            sidebar.classList.toggle('translate-x-0', isMobileSidebarOpen);
            mobileSidebarOverlay.classList.toggle('hidden', !isMobileSidebarOpen);
            mobileSidebarToggle.setAttribute('aria-expanded', isMobileSidebarOpen);
            mobileSidebarToggle.querySelector('span.sr-only').textContent = isMobileSidebarOpen ? 'Close sidebar' : 'Open sidebar';

            if (isMobileSidebarOpen) {
                wasDesktopCollapsedBeforeMobileOpen = isSidebarCollapsed; // Store current desktop state
                applyDesktopCollapseStyles(false); // Always expand for mobile view
            } else {
                // Revert to stored desktop state only if on desktop view
                if (window.innerWidth >= 1024) {
                    applyDesktopCollapseStyles(wasDesktopCollapsedBeforeMobileOpen);
                }
            }
          });
          mobileSidebarOverlay.addEventListener('click', () => { if (isMobileSidebarOpen) mobileSidebarToggle.click(); });
        }
        document.querySelectorAll('#sidebar .sidebar-nav-item, #sidebar-user-profile-area a').forEach(link => {
            link.addEventListener('click', () => { if (isMobileSidebarOpen && window.innerWidth < 1024) mobileSidebarToggle.click(); });
        });

        if (userMenuButton && userMenuDropdown) { 
          userMenuButton.addEventListener('click', (event) => { event.stopPropagation(); isUserMenuOpen = !isUserMenuOpen; userMenuDropdown.classList.toggle('hidden', !isUserMenuOpen); userMenuButton.setAttribute('aria-expanded', isUserMenuOpen); });
          document.addEventListener('click', (event) => { if (isUserMenuOpen && !userMenuDropdown.contains(event.target) && !userMenuButton.contains(event.target)) { isUserMenuOpen = false; userMenuDropdown.classList.add('hidden'); userMenuButton.setAttribute('aria-expanded', false); } });
          userMenuDropdown.querySelectorAll('.user-menu-item').forEach(item => { item.addEventListener('click', () => { isUserMenuOpen = false; userMenuDropdown.classList.add('hidden'); userMenuButton.setAttribute('aria-expanded', false); }); });
        }
        
        if (desktopSidebarToggleButton) { 
            desktopSidebarToggleButton.addEventListener('click', toggleDesktopSidebar); 
            // Apply initial desktop collapsed state if not on mobile
            if (window.innerWidth >= 1024) {
                applyDesktopCollapseStyles(isSidebarCollapsed);
                 if (desktopSidebarToggleButton) {
                    desktopSidebarToggleButton.setAttribute('aria-expanded', !isSidebarCollapsed);
                    desktopSidebarToggleButton.title = isSidebarCollapsed ? 'Expand sidebar' : 'Collapse sidebar';
                    desktopSidebarToggleButton.querySelector('span.sr-only').textContent = isSidebarCollapsed ? 'Expand sidebar' : 'Collapse sidebar';
                }
            } else {
                 applyDesktopCollapseStyles(false); // Ensure expanded on mobile initially if desktop was collapsed
            }
        }
        // --- End Sidebar and Header JS ---


        // --- Claim Detail Logic ---
        const claimDetailLoadingEl = document.getElementById('claim-detail-loading');
        const claimDetailErrorEl = document.getElementById('claim-detail-error');
        const errorMessageTextEl = document.getElementById('error-message-text');
        const claimDetailContentWrapperEl = document.getElementById('claim-detail-content');
        
        const getStatusBadgeHTML = (status, large = false) => {
            let bgColor = 'bg-slate-100'; let textColor = 'text-slate-700'; let IconId = 'status-inconclusive-icon-solid';
            switch (status) {
                case 'verified': bgColor = 'bg-green-100'; textColor = 'text-green-700'; IconId = 'status-verified-icon-solid'; break;
                case 'debunked': bgColor = 'bg-red-100'; textColor = 'text-red-700'; IconId = 'status-debunked-icon-solid'; break;
                case 'pending': bgColor = 'bg-sky-100'; textColor = 'text-sky-700'; IconId = 'status-pending-icon-solid'; break;
            }
            const sizeClass = large ? 'px-4 py-1.5 text-sm' : 'px-2.5 py-0.5 text-xs';
            const iconSizeClass = large ? 'w-5 h-5' : 'w-4 h-4';
            return `<span class="inline-flex items-center rounded-full font-medium ${bgColor} ${textColor} ${sizeClass}"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="mr-1.5 ${iconSizeClass}"><use href="#${IconId}" /></svg>${status.charAt(0).toUpperCase() + status.slice(1)}</span>`;
        };

        const renderClaimDetail = (claimData) => {
            if (!claimData) { // Handle case where claimData might be null if not found
                errorMessageTextEl.textContent = "Claim details not found.";
                claimDetailLoadingEl.classList.add('hidden');
                claimDetailErrorEl.classList.remove('hidden');
                claimDetailContentWrapperEl.classList.add('hidden');
                return;
            }
            const formattedDate = new Date(claimData.verificationDate).toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric', hour: '2-digit', minute: '2-digit' });
            let evidenceHTML = '';
            if (claimData.evidenceLinks && claimData.evidenceLinks.length > 0) {
                evidenceHTML = `<section><div class="flex items-center mb-3"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6 text-sky-600 mr-2"><use href="#paperclip-icon-solid" /></svg><h2 class="text-xl font-semibold text-slate-800">Supporting Evidence</h2></div><ul class="space-y-2">${claimData.evidenceLinks.map(link => `<li><a href="${link.url}" target="_blank" rel="noopener noreferrer" class="inline-flex items-center text-sm text-sky-600 hover:text-sky-800 hover:underline group"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-4 h-4 mr-1.5 opacity-70 group-hover:opacity-100"><use href="#link-icon-solid" /></svg>${link.title}</a></li>`).join('')}</ul></section>`;
            }
            const paragraphsHTML = claimData.detailedExplanation.split('\n').map(p => `<p>${p.trim() ? p : 'Â '}</p>`).join(''); // Ensure empty lines are rendered as paragraphs

            claimDetailContentWrapperEl.innerHTML = `
                <div class="max-w-4xl mx-auto">
                    <div class="mb-6">
                        <a href="history-list.html" class="inline-flex items-center text-sm font-medium text-sky-600 hover:text-sky-800 group">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5 mr-2 text-sky-500 group-hover:text-sky-700 transition-colors"><path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5L3 12m0 0l7.5-7.5M3 12h18" /></svg>
                            Back to Verification History
                        </a>
                    </div>
                    <div class="bg-white rounded-xl shadow-xl overflow-hidden">
                        ${claimData.imageUrl ? `<div class="bg-slate-200"><img src="${claimData.imageUrl}" alt="Claim related image" class="w-full h-60 sm:h-80 md:h-96 object-contain p-2 bg-slate-50" /></div>` : ''}
                        <div class="p-6 sm:p-8">
                            <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between mb-5 pb-5 border-b border-slate-200">
                                ${getStatusBadgeHTML(claimData.status, true)}
                                <div class="flex items-center text-sm text-slate-500 mt-3 sm:mt-0">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-5 h-5 mr-1.5 text-slate-400"><use href="#status-pending-icon-solid" /></svg>
                                    Verified on: ${formattedDate}
                                </div>
                            </div>
                            <section class="mb-8">
                                <h2 class="text-xs font-semibold text-slate-500 uppercase tracking-wider mb-1">Original Claim</h2>
                                <p class="text-lg sm:text-xl text-slate-800 leading-relaxed whitespace-pre-wrap">${claimData.claimText}</p>
                                ${claimData.originalSource ? `<div class="mt-3 flex items-center text-sm text-slate-500"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-4 h-4 mr-1.5 text-slate-400"><use href="#link-icon-solid" /></svg>Source: <span class="ml-1 font-medium text-slate-600 truncate">${claimData.originalSource}</span></div>` : ''}
                            </section>
                            <section class="mb-8">
                                <div class="flex items-center mb-3">
                                   <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6 text-sky-600 mr-2"><use href="#chat-bubble-icon-solid" /></svg>
                                    <h2 class="text-xl font-semibold text-slate-800">Verification Details</h2>
                                </div>
                                <div class="prose prose-sm sm:prose-base max-w-none text-slate-700 leading-relaxed">${paragraphsHTML}</div>
                            </section>
                            ${evidenceHTML}
                        </div>
                    </div>
                </div>`;
            claimDetailLoadingEl.classList.add('hidden');
            claimDetailErrorEl.classList.add('hidden');
            claimDetailContentWrapperEl.classList.remove('hidden');
        };

        const fetchClaimDetail = async () => {
            const params = new URLSearchParams(window.location.search);
            const claimIdFromUrl = params.get('id');

            claimDetailLoadingEl.classList.remove('hidden');
            claimDetailErrorEl.classList.add('hidden');
            claimDetailContentWrapperEl.classList.add('hidden');

            try {
                await new Promise(resolve => setTimeout(resolve, 700)); // Simulate network delay
                
                if (!claimIdFromUrl) {
                    throw new Error("No Claim ID provided in the URL.");
                }

                const selectedClaim = allHistoryItems.find(item => item.id === claimIdFromUrl);
                
                if (selectedClaim) {
                    renderClaimDetail(selectedClaim);
                } else {
                    throw new Error(`Claim with ID "${claimIdFromUrl}" not found.`);
                }
            } catch (e) {
                errorMessageTextEl.textContent = e.message || "Failed to load claim details.";
                claimDetailLoadingEl.classList.add('hidden');
                claimDetailErrorEl.classList.remove('hidden');
                claimDetailContentWrapperEl.classList.add('hidden');
            }
        };

        fetchClaimDetail();
      });
    </script>
</body>
</html>